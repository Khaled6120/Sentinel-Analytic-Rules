{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/7b582f1a-b318-4c6a-bf4e-66fe49bf55a5')]",
      "kind": "NRT",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/7b582f1a-b318-4c6a-bf4e-66fe49bf55a5')]",
      "properties": {
        "alertRuleTemplateName": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @Kostastsale",
        "customDetails": null,
        "date": "2022/02/25",
        "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
        "displayName": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2024/02/28",
        "query": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\bitsadmin.exe\" or FolderPath endswith \"\\\\cmd.exe\" or FolderPath endswith \"\\\\curl.exe\" or FolderPath endswith \"\\\\dllhost.exe\" or FolderPath endswith \"\\\\net.exe\" or FolderPath endswith \"\\\\nltest.exe\" or FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\" or FolderPath endswith \"\\\\rundll32.exe\" or FolderPath endswith \"\\\\wevtutil.exe\") and (InitiatingProcessCommandLine contains \":\\\\Windows\\\\TEMP\\\\ScreenConnect\\\\\" and InitiatingProcessCommandLine contains \"run.cmd\")",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "medium",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": null,
        "techniques": [
          "t1219"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
