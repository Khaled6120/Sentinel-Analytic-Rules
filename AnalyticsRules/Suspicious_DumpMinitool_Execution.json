{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/eb1c4225-1c23-4241-8dd4-051389fde4ce')]",
      "kind": "NRT",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/eb1c4225-1c23-4241-8dd4-051389fde4ce')]",
      "properties": {
        "alertRuleTemplateName": "eb1c4225-1c23-4241-8dd4-051389fde4ce",
        "author": "Florian Roth (Nextron Systems)",
        "customDetails": null,
        "date": "2022/04/06",
        "description": "Detects suspicious ways to use the \"DumpMinitool.exe\" binary",
        "displayName": "Suspicious DumpMinitool Execution",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2023/04/12",
        "query": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\DumpMinitool.exe\" or FolderPath endswith \"\\\\DumpMinitool.x86.exe\" or FolderPath endswith \"\\\\DumpMinitool.arm64.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"DumpMinitool.exe\", \"DumpMinitool.x86.exe\", \"DumpMinitool.arm64.exe\"))) and ((not((FolderPath contains \"\\\\Microsoft Visual Studio\\\\\" or FolderPath contains \"\\\\Extensions\\\\\"))) or ProcessCommandLine contains \".txt\" or ((ProcessCommandLine contains \" Full\" or ProcessCommandLine contains \" Mini\" or ProcessCommandLine contains \" WithHeap\") and (not(ProcessCommandLine contains \"--dumpType\"))))",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "high",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": null,
        "techniques": [
          "t1003",
          "t1036"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
