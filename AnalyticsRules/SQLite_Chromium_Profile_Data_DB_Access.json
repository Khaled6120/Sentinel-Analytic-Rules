{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/24c77512-782b-448a-8950-eddb0785fc71')]",
      "kind": "NRT",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/24c77512-782b-448a-8950-eddb0785fc71')]",
      "properties": {
        "alertRuleTemplateName": "24c77512-782b-448a-8950-eddb0785fc71",
        "author": "TropChaud",
        "customDetails": null,
        "date": "2022/12/19",
        "description": "Detect usage of the \"sqlite\" binary to query databases in Chromium-based browsers for potential data stealing.",
        "displayName": "SQLite Chromium Profile Data DB Access",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2023/01/19",
        "query": "DeviceProcessEvents\n| where (ProcessCommandLine contains \"\\\\User Data\\\\\" or ProcessCommandLine contains \"\\\\Opera Software\\\\\" or ProcessCommandLine contains \"\\\\ChromiumViewer\\\\\") and (ProcessCommandLine contains \"Login Data\" or ProcessCommandLine contains \"Cookies\" or ProcessCommandLine contains \"Web Data\" or ProcessCommandLine contains \"History\" or ProcessCommandLine contains \"Bookmarks\") and (ProcessVersionInfoProductName =~ \"SQLite\" or (FolderPath endswith \"\\\\sqlite.exe\" or FolderPath endswith \"\\\\sqlite3.exe\"))",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "high",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": [
          "collection"
        ],
        "techniques": [
          "t1005",
          "t1539",
          "t1555"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
