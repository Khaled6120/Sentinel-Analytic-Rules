{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/089fc3d2-71e8-4763-a8a5-c97fbb0a403e')]",
      "kind": "Scheduled",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/089fc3d2-71e8-4763-a8a5-c97fbb0a403e')]",
      "properties": {
        "alertRuleTemplateName": "089fc3d2-71e8-4763-a8a5-c97fbb0a403e",
        "author": "Florian Roth (Nextron Systems), frack113",
        "customDetails": null,
        "date": "2021/11/29",
        "description": "Detects the execution of REGSVR32.exe with DLL files masquerading as other files",
        "displayName": "Regsvr32 DLL Execution With Suspicious File Extension",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2023/05/24",
        "query": "DeviceProcessEvents\n| where (ProcessCommandLine endswith \".bin\" or ProcessCommandLine endswith \".bmp\" or ProcessCommandLine endswith \".cr2\" or ProcessCommandLine endswith \".dat\" or ProcessCommandLine endswith \".eps\" or ProcessCommandLine endswith \".gif\" or ProcessCommandLine endswith \".ico\" or ProcessCommandLine endswith \".jpeg\" or ProcessCommandLine endswith \".jpg\" or ProcessCommandLine endswith \".nef\" or ProcessCommandLine endswith \".orf\" or ProcessCommandLine endswith \".png\" or ProcessCommandLine endswith \".raw\" or ProcessCommandLine endswith \".sr2\" or ProcessCommandLine endswith \".temp\" or ProcessCommandLine endswith \".tif\" or ProcessCommandLine endswith \".tiff\" or ProcessCommandLine endswith \".tmp\" or ProcessCommandLine endswith \".rtf\" or ProcessCommandLine endswith \".txt\") and (FolderPath endswith \"\\\\regsvr32.exe\" or ProcessVersionInfoOriginalFileName =~ \"REGSVR32.EXE\")",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "high",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": null,
        "techniques": [
          "T1218"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
