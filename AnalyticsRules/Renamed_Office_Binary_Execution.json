{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/0b0cd537-fc77-4e6e-a973-e53495c1083d')]",
      "kind": "NRT",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/0b0cd537-fc77-4e6e-a973-e53495c1083d')]",
      "properties": {
        "alertRuleTemplateName": "0b0cd537-fc77-4e6e-a973-e53495c1083d",
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "customDetails": null,
        "date": "2022/12/20",
        "description": "Detects the execution of a renamed office binary",
        "displayName": "Renamed Office Binary Execution",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2023/11/13",
        "query": "DeviceProcessEvents\n| where ((ProcessVersionInfoOriginalFileName in~ (\"Excel.exe\", \"MSACCESS.EXE\", \"MSPUB.EXE\", \"OneNote.exe\", \"OneNoteM.exe\", \"OUTLOOK.EXE\", \"POWERPNT.EXE\", \"WinWord.exe\")) or (ProcessVersionInfoFileDescription in~ (\"Microsoft Access\", \"Microsoft Excel\", \"Microsoft OneNote\", \"Microsoft Outlook\", \"Microsoft PowerPoint\", \"Microsoft Publisher\", \"Microsoft Word\", \"Sent to OneNote Tool\"))) and (not((FolderPath endswith \"\\\\EXCEL.exe\" or FolderPath endswith \"\\\\excelcnv.exe\" or FolderPath endswith \"\\\\MSACCESS.exe\" or FolderPath endswith \"\\\\MSPUB.EXE\" or FolderPath endswith \"\\\\ONENOTE.EXE\" or FolderPath endswith \"\\\\ONENOTEM.EXE\" or FolderPath endswith \"\\\\OUTLOOK.EXE\" or FolderPath endswith \"\\\\POWERPNT.EXE\" or FolderPath endswith \"\\\\WINWORD.exe\")))",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "high",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": null,
        "techniques": [],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
