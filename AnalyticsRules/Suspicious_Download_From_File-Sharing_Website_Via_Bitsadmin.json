{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/8518ed3d-f7c9-4601-a26c-f361a4256a0c')]",
      "kind": "Scheduled",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/8518ed3d-f7c9-4601-a26c-f361a4256a0c')]",
      "properties": {
        "alertRuleTemplateName": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
        "author": "Florian Roth (Nextron Systems)",
        "customDetails": null,
        "date": "2022/06/28",
        "description": "Detects usage of bitsadmin downloading a file from a suspicious domain",
        "displayName": "Suspicious Download From File-Sharing Website Via Bitsadmin",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2024/02/09",
        "query": "DeviceProcessEvents\n| where (ProcessCommandLine contains \".githubusercontent.com\" or ProcessCommandLine contains \"anonfiles.com\" or ProcessCommandLine contains \"cdn.discordapp.com\" or ProcessCommandLine contains \"cdn.discordapp.com/attachments/\" or ProcessCommandLine contains \"ddns.net\" or ProcessCommandLine contains \"dl.dropboxusercontent.com\" or ProcessCommandLine contains \"ghostbin.co\" or ProcessCommandLine contains \"glitch.me\" or ProcessCommandLine contains \"gofile.io\" or ProcessCommandLine contains \"hastebin.com\" or ProcessCommandLine contains \"mediafire.com\" or ProcessCommandLine contains \"mega.nz\" or ProcessCommandLine contains \"onrender.com\" or ProcessCommandLine contains \"paste.ee\" or ProcessCommandLine contains \"pastebin.com\" or ProcessCommandLine contains \"pastebin.pl\" or ProcessCommandLine contains \"pastetext.net\" or ProcessCommandLine contains \"privatlab.com\" or ProcessCommandLine contains \"privatlab.net\" or ProcessCommandLine contains \"send.exploit.in\" or ProcessCommandLine contains \"sendspace.com\" or ProcessCommandLine contains \"storage.googleapis.com\" or ProcessCommandLine contains \"storjshare.io\" or ProcessCommandLine contains \"supabase.co\" or ProcessCommandLine contains \"temp.sh\" or ProcessCommandLine contains \"transfer.sh\" or ProcessCommandLine contains \"ufile.io\") and (ProcessCommandLine contains \" /transfer \" or ProcessCommandLine contains \" /create \" or ProcessCommandLine contains \" /addfile \") and (FolderPath endswith \"\\\\bitsadmin.exe\" or ProcessVersionInfoOriginalFileName =~ \"bitsadmin.exe\")",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "high",
        "status": "experimental",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": [
          "Persistence"
        ],
        "techniques": [
          "T1036",
          "T1197"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
