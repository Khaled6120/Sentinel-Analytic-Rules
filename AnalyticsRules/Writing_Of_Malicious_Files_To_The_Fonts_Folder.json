{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "apiVersion": "2023-02-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/ae9b0bd7-8888-4606-b444-0ed7410cb728')]",
      "kind": "Scheduled",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/ae9b0bd7-8888-4606-b444-0ed7410cb728')]",
      "properties": {
        "alertRuleTemplateName": "ae9b0bd7-8888-4606-b444-0ed7410cb728",
        "author": "Sreeman",
        "customDetails": null,
        "date": "2020/04/21",
        "description": "Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\ location. This folder doesn't require admin privillege to be written and executed from.",
        "displayName": "Writing Of Malicious Files To The Fonts Folder",
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "modified": "2022/03/08",
        "query": "DeviceProcessEvents\n| where (ProcessCommandLine contains \"echo\" or ProcessCommandLine contains \"copy\" or ProcessCommandLine contains \"type\" or ProcessCommandLine contains \"file createnew\" or ProcessCommandLine contains \"cacls\") and ProcessCommandLine contains \"C:\\\\Windows\\\\Fonts\\\\\" and (ProcessCommandLine contains \".sh\" or ProcessCommandLine contains \".exe\" or ProcessCommandLine contains \".dll\" or ProcessCommandLine contains \".bin\" or ProcessCommandLine contains \".bat\" or ProcessCommandLine contains \".cmd\" or ProcessCommandLine contains \".js\" or ProcessCommandLine contains \".msh\" or ProcessCommandLine contains \".reg\" or ProcessCommandLine contains \".scr\" or ProcessCommandLine contains \".ps\" or ProcessCommandLine contains \".vb\" or ProcessCommandLine contains \".jar\" or ProcessCommandLine contains \".pl\" or ProcessCommandLine contains \".inf\" or ProcessCommandLine contains \".cpl\" or ProcessCommandLine contains \".hta\" or ProcessCommandLine contains \".msi\" or ProcessCommandLine contains \".vbs\")",
        "queryFrequency": "P1D",
        "queryPeriod": "P1D",
        "sentinelEntitiesMappings": null,
        "severity": "medium",
        "status": "test",
        "suppressionDuration": "PT5H",
        "suppressionEnabled": false,
        "tactics": [
          "Persistence"
        ],
        "techniques": [
          "T1059",
          "T1211"
        ],
        "templateVersion": "1.0.0",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0
      },
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules"
    }
  ]
}
